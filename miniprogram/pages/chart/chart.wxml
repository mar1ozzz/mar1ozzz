<view class="table-container" bindlongpress="onLongPress">
  <view class="table">
    <view class="table-header">
      <text class="header-item">éƒ¨é—¨/åŒºå¿</text>
      <text class="header-item">æ€»è®¡</text>
      <text class="header-item">å¾…å›å¤</text>
      <text class="header-item">è§„åˆ’ä¸­</text>
      <text class="header-item">å»ºè®¾ä¸­</text>
      <text class="header-item">æš‚æŒ‚ä¸­</text>
      <text class="header-item">å·²è§£å†³</text>
      <text class="header-item">è§£å†³ç‡</text>
    </view>
    <view class="table-body">
      <block wx:for="{{tableData}}" wx:key="index">
        <view class="table-row">
          <text class="row-item">{{item.author}}</text>
          <text class="row-item clickable" data-type="total" data-author="{{item.author}}" 
                bindtap="handleCellTap">{{item.total}}</text>
          <text class="row-item clickable" style="color: {{item.A > 0 ? 'red' : 'black'}}" 
                data-type="A" data-author="{{item.author}}" bindtap="handleCellTap">{{item.A}}</text>
          <text class="row-item clickable" style="color: {{item.B > 0 ? 'red' : 'black'}}"
                data-type="B" data-author="{{item.author}}" bindtap="handleCellTap">{{item.B}}</text>
          <text class="row-item clickable" style="color: {{item.C > 0 ? 'red' : 'black'}}"
                data-type="C" data-author="{{item.author}}" bindtap="handleCellTap">{{item.C}}</text>
          <text class="row-item clickable" style="color: {{item.D > 0 ? 'red' : 'black'}}"
                data-type="D" data-author="{{item.author}}" bindtap="handleCellTap">{{item.D}}</text>
          <text class="row-item clickable" data-type="E" data-author="{{item.author}}" 
                bindtap="handleCellTap">{{item.E}}</text>
          <text class="row-item">{{item.rate}}</text>
        </view>
      </block>
      <!-- Total Row -->
      <view class="table-row total-row">
        <text class="row-item">æ€»è®¡</text>
        <text class="row-item clickable" data-type="total" data-author="total" 
              bindtap="handleCellTap">{{total.total}}</text>
        <text class="row-item clickable" style="color: {{total.A > 0 ? 'red' : 'black'}}"
              data-type="A" data-author="total" bindtap="handleCellTap">{{total.A}}</text>
        <text class="row-item clickable" style="color: {{total.B > 0 ? 'red' : 'black'}}"
              data-type="B" data-author="total" bindtap="handleCellTap">{{total.B}}</text>
        <text class="row-item clickable" style="color: {{total.C > 0 ? 'red' : 'black'}}"
              data-type="C" data-author="total" bindtap="handleCellTap">{{total.C}}</text>
        <text class="row-item clickable" style="color: {{total.D > 0 ? 'red' : 'black'}}"
              data-type="D" data-author="total" bindtap="handleCellTap">{{total.D}}</text>
        <text class="row-item clickable" data-type="E" data-author="total" 
              bindtap="handleCellTap">{{total.E}}</text>
        <text class="row-item">{{total.rate}}</text>
      </view>
    </view>
  </view>
</view>

<!-- ä¸ªäººå¾…å¤„ç†ç»Ÿè®¡è¡¨æ ¼ -->
<view class="table-container" style="margin-top: 20px;">
  <view class="table">
    <view class="table-header">
      <text class="header-item">å¤„ç†äºº</text>
      <text class="header-item">å¾…å¤„ç†æ•°é‡</text>
      <text class="header-item">å·²å¤„ç†æ•°é‡</text>
      <text class="header-item">å¤„ç†ç‡</text>
    </view>
    <view class="table-body">
      <block wx:for="{{personStats}}" wx:key="username">
        <view class="table-row">
          <text class="row-item">{{item.username}}</text>
          <text class="row-item clickable" style="color: {{item.pendingCount > 0 ? 'red' : 'black'}}"
                data-type="pending" data-author="person_{{item.username}}" 
                bindtap="handleCellTap">{{item.pendingCount}}</text>
          <text class="row-item clickable" data-type="solved" data-author="person_{{item.username}}"
                bindtap="handleCellTap">{{item.solvedCount}}</text>
          <text class="row-item">{{item.rate}}</text>
        </view>
      </block>
      <!-- Person Total Row -->
      <view class="table-row total-row">
        <text class="row-item">æ€»è®¡</text>
        <text class="row-item clickable" style="color: {{personTotal.pendingCount > 0 ? 'red' : 'black'}}"
              data-type="pending" data-author="person_total" 
              bindtap="handleCellTap">{{personTotal.pendingCount}}</text>
        <text class="row-item clickable" data-type="solved" data-author="person_total"
              bindtap="handleCellTap">{{personTotal.solvedCount}}</text>
        <text class="row-item">{{personTotal.rate}}</text>
      </view>
    </view>
  </view>
</view>

<!-- æ·»åŠ ä¿å­˜æŒ‰é’® -->
<view class="save-button-container">
  <button class="save-button" bindtap="saveToImage">
    <text class="save-icon">ğŸ“·</text>
    ä¿å­˜ä¸ºå›¾ç‰‡
  </button>
</view>